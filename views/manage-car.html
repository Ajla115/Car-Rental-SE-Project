<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Manage Cars</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicon -->
  <link href="../assets/img/car-icon.png" rel="icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="../assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="../assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="../assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="../assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="../assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="../assets/vendor/remixicon/remixicon.css" rel="stylesheet">
  <link href="../assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.17.0/jquery.validate.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <script src="https://code.highcharts.com/highcharts.js"></script>
  <script src="https://code.highcharts.com/modules/series-label.js"></script>
  <script src="https://code.highcharts.com/modules/exporting.js"></script>
  <script src="https://code.highcharts.com/modules/export-data.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/toastr@2.1.4/build/toastr.min.js"></script>
  <script src="./assets/js/jquery.spapp.js"></script>
  <script src="./assets/js/custom.js"></script>
  <script src="./assets/js/intro.js"></script>
  <script src="./assets/js/utils.js"></script>
  <script src="./assets/js/rest-client.js"></script>
  <script src="assets/js/user-service.js"></script>
  <script src="./config.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="./assets/js/jQuerySPApp.js"></script>

  <link href="../assets/css/style.css" rel="stylesheet">

  <style>
    /* Custom styles for car management table */
    .table-custom {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    .table-custom th, .table-custom td {
      border: 1px solid #ddd;
      padding: 12px;
      text-align: left;
    }

    .table-custom th {
      background-color: #f2f2f2;
      color: #333;
    }

    .table-custom tr:nth-child(even) {
      background-color: #f9f9f9;
    }

    .table-custom tr:hover {
      background-color: #f1f1f1;
    }

    /* Custom styles for buttons */
    .btn-custom {
      background-color: #FFA500;
      color: white;
      border: none;
      padding: 10px 20px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 14px;
      margin: 4px 2px;
      cursor: pointer;
      border-radius: 5px;
      transition: background-color 0.3s ease;
    }

    .btn-custom:hover {
      background-color: #ce9429;
    }

    .btn-group {
      display: flex;
      gap: 10px;
    }
  </style>
</head>
<body>
  <header class="header">
    <!-- Header content, if any -->
  </header>

  <main>
    <section class="car-management">
      <div class="container" data-aos="fade-up">
        <h1 class="text-center">Manage Cars</h1>
        <!--<button class="btn-custom" onclick="history.back()">Go Back</button>-->
        <button class="btn-custom" onclick="history.back()">Go Back</button>
        <div class="table-responsive">
          <table class="table-custom">
            <thead>
              <tr>
                <th>Car Name</th>
                <th>Price</th>
                <th>Age</th>
                <th>Mileage</th>
                <th>Fuel</th>
                <th>Fuel Usage</th>
                <th>Gearbox</th>
                <th>Max Passengers</th>
                <th>Car Type</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="carList">
              <!-- Car rows will be dynamically populated here -->
            </tbody>
          </table>
        </div>
      </div>
    </section>
  </main>

  <script>
    $(document).ready(function() {
      loadCars();
    });

    function loadCars() {
      $.ajax({
        url: '../rest/carinfo',
        type: 'GET',
        success: function(data) {
          const carList = $('#carList');
          carList.empty();
          data.forEach(function(car) {
            const carRow = `
              <tr>
                <td>${car.car_name}</td>
                <td>${car.price}</td>
                <td>${car.age}</td>
                <td>${car.mileage}</td>
                <td>${car.fuel}</td>
                <td>${car.fuel_usage}</td>
                <td>${car.gearbox}</td>
                <td>${car.max_passengers}</td>
                <td>${car.car_type}</td>
                <td>
                  <div class="btn-group">
                    <button onclick="deleteCar(${car.id})" class="btn-custom btn-danger">Delete</button>
                    <button onclick="location.href='edit-car.html?id=${car.id}'" class="btn-custom btn-primary">Edit</button>
                  </div>
                </td>
              </tr>
            `;
            carList.append(carRow);
          });
        },
        error: function(jqXHR, textStatus, errorThrown) {
          console.error('Error loading cars:', textStatus, errorThrown);
        }
      });
    }

    function deleteCar(id) {
      if (confirm('Are you sure you want to delete this car?')) {
        $.ajax({
          url: `../rest/carinfo/${id}`,
          type: 'DELETE',
          success: function(response) {
            alert('Car deleted successfully');
            loadCars();
          },
          error: function(jqXHR, textStatus, errorThrown) {
            console.error('Error deleting car:', textStatus, errorThrown);
          }
        });
      }
    }
  </script>

  <!-- Vendor JS Files -->
  <script src="../assets/vendor/aos/aos.js"></script>
  <script src="../assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="../assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="../assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="../assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="../assets/vendor/php-email-form/validate.js"></script>

  <!-- Custom JS File -->
  <script src="../assets/js/main.js"></script>
</body>
</html>
